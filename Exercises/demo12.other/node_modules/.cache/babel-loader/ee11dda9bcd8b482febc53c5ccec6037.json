{"ast":null,"code":"var _jsxFileName = \"D:\\\\Project\\\\RecatProject\\\\Exercises\\\\demo12.other\\\\src\\\\components\\\\ExportExcel.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { Table, Button } from 'antd';\nimport ExportJsonExcel from 'js-export-excel'; // 总量数据表格数据源\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst columnSum = [{\n  title: '日期',\n  dataIndex: 'id',\n  key: 'id',\n  align: 'center',\n  render: () => `${formVals.startTime ? `${formVals.startTime}至` : '至今'}${formVals.endTime ? formVals.endTime : ''}`\n}, {\n  title: '新增企业数',\n  dataIndex: 'intervalCompanyNum',\n  key: 'intervalCompanyNum',\n  align: 'center'\n}, {\n  title: '活跃企业数',\n  dataIndex: 'intervalActiviteCompanyNum',\n  key: 'intervalActiviteCompanyNum',\n  align: 'center'\n}, {\n  title: '新增用户数',\n  key: 'intervalUserNum',\n  dataIndex: 'intervalUserNum',\n  align: 'center'\n}, {\n  title: '活跃用户数',\n  key: 'intervalActiviteUserNum',\n  dataIndex: 'intervalActiviteUserNum',\n  align: 'center'\n}, {\n  title: '新增模版数',\n  key: 'intervalTemplateNum',\n  dataIndex: 'intervalTemplateNum',\n  align: 'center'\n}, {\n  title: '新增作品数',\n  key: 'intervalSceneNum',\n  dataIndex: 'intervalSceneNum',\n  align: 'center'\n}, {\n  title: '有作品企业数',\n  key: 'intervalSceneCompanyNum',\n  dataIndex: 'intervalSceneCompanyNum',\n  align: 'center'\n}, {\n  title: '有作品用户数',\n  key: 'intervalSceneUserNum',\n  dataIndex: 'intervalSceneUserNum',\n  align: 'center'\n}, {\n  title: '下载用户数',\n  key: 'intervalDownloadUserNum',\n  dataIndex: 'intervalDownloadUserNum',\n  align: 'center'\n} // {\n//   title: '作品下载数',\n//   key: 'downloadSceneNum',\n//   dataIndex: 'downloadSceneNum',\n// },\n]; // 数据筛选-单日数据-表格数据源\n\nconst columns = [{\n  title: '日期',\n  dataIndex: 'dateTime',\n  key: 'dateTime',\n  align: 'center'\n}, {\n  title: '新增企业数',\n  dataIndex: 'companyNum',\n  key: 'companyNum',\n  align: 'center'\n}, {\n  title: '活跃企业数',\n  dataIndex: 'activiteCompanyNum',\n  key: 'activiteCompanyNum',\n  align: 'center'\n}, {\n  title: '新增用户数',\n  key: 'userNum',\n  dataIndex: 'userNum',\n  align: 'center'\n}, {\n  title: '活跃用户数',\n  key: 'activiteUserNum',\n  dataIndex: 'activiteUserNum',\n  align: 'center'\n}, {\n  title: '新增模版数',\n  key: 'templateNum',\n  dataIndex: 'templateNum',\n  align: 'center'\n}, {\n  title: '新增作品数',\n  key: 'sceneNum',\n  dataIndex: 'sceneNum',\n  align: 'center'\n}, {\n  title: '有作品企业数',\n  key: 'sceneCompanyNum',\n  dataIndex: 'sceneCompanyNum',\n  align: 'center'\n}, {\n  title: '有作品用户数',\n  key: 'sceneUserNum',\n  dataIndex: 'sceneUserNum',\n  align: 'center'\n}, {\n  title: '下载用户数',\n  key: 'downloadUserNum',\n  dataIndex: 'downloadUserNum',\n  align: 'center'\n}];\n\nconst ExportExcel = () => {\n  _s();\n\n  const cloneData = {\n    id: 1,\n    intervalActiviteCompanyNum: 5864,\n    intervalActiviteUserNum: 8458,\n    intervalCompanyNum: 1854,\n    intervalSceneNum: 84459,\n    intervalUserNum: 4451,\n    intervalTemplateNum: 695,\n    intervalDownloadUserNum: 85,\n    intervalSceneCompanyNum: 62,\n    intervalSceneUserNum: 754\n  };\n  useEffect(() => {// console.log(singleData.records);\n  }); // 下载表格数据\n\n  const downloadExcel = type => {\n    const data = cloneData; // 表格数据\n\n    const option = {};\n    const dataTable = [];\n\n    if (data) {\n      Object.values(data).forEach(item => {\n        const obj = {\n          日期: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.dateTime : `${formVals.startTime ? `${formVals.startTime}至` : '至今'}${formVals.endTime ? formVals.endTime : ''}`,\n          新增企业数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.companyNum : item === null || item === void 0 ? void 0 : item.intervalCompanyNum,\n          活跃企业数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.activiteCompanyNum : item === null || item === void 0 ? void 0 : item.intervalActiviteCompanyNum,\n          新增用户数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.userNum : item === null || item === void 0 ? void 0 : item.intervalUserNum,\n          活跃用户数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.activiteUserNum : item === null || item === void 0 ? void 0 : item.intervalActiviteUserNum,\n          新增模版数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.templateNum : item === null || item === void 0 ? void 0 : item.intervalTemplateNum,\n          新增作品数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.sceneNum : item === null || item === void 0 ? void 0 : item.intervalSceneNum,\n          有作品企业数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.sceneCompanyNum : item === null || item === void 0 ? void 0 : item.intervalSceneCompanyNum,\n          有作品用户数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.sceneUserNum : item === null || item === void 0 ? void 0 : item.intervalSceneUserNum,\n          下载用户数: type === 'singleData' ? item === null || item === void 0 ? void 0 : item.downloadUserNum : item === null || item === void 0 ? void 0 : item.intervalDownloadUserNum\n        };\n        dataTable.push(obj);\n      });\n    }\n\n    option.fileName = type === 'singleData' ? '单日数据' : '总量数据';\n    option.datas = [{\n      sheetData: dataTable,\n      sheetName: 'sheet',\n      sheetFilter: ['日期', '新增企业数', '活跃企业数', '新增用户数', '活跃用户数', '新增模版数', '新增作品数', '有作品企业数', '有作品用户数', '下载用户数'],\n      sheetHeader: ['日期', '新增企业数', '活跃企业数', '新增用户数', '活跃用户数', '新增模版数', '新增作品数', '有作品企业数', '有作品用户数', '下载用户数']\n    }];\n    const toExcel = new ExportJsonExcel(option);\n    toExcel.saveExcel();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      className: \"title-header\",\n      children: [\"\\u603B\\u91CF\\u6570\\u636E\", /*#__PURE__*/_jsxDEV(Button, {\n        type: \"primary\",\n        style: {\n          float: 'right'\n        },\n        onClick: () => downloadExcel('summaryData'),\n        children: \"\\u5BFC\\u51FA\\u6570\\u636E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      align: \"center\",\n      pagination: false,\n      columns: columnSum,\n      dataSource: [cloneData],\n      rowKey: summaryData => summaryData.id,\n      className: \"form-container\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 192,\n    columnNumber: 7\n  }, this);\n};\n\n_s(ExportExcel, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = ExportExcel;\nexport default ExportExcel; // 此文件是  数据概览  -  海报-数据看板  -  数据筛选  组件\n\nvar _c;\n\n$RefreshReg$(_c, \"ExportExcel\");","map":{"version":3,"sources":["D:/Project/RecatProject/Exercises/demo12.other/src/components/ExportExcel.jsx"],"names":["React","useEffect","Table","Button","ExportJsonExcel","columnSum","title","dataIndex","key","align","render","formVals","startTime","endTime","columns","ExportExcel","cloneData","id","intervalActiviteCompanyNum","intervalActiviteUserNum","intervalCompanyNum","intervalSceneNum","intervalUserNum","intervalTemplateNum","intervalDownloadUserNum","intervalSceneCompanyNum","intervalSceneUserNum","downloadExcel","type","data","option","dataTable","Object","values","forEach","item","obj","日期","dateTime","新增企业数","companyNum","活跃企业数","activiteCompanyNum","新增用户数","userNum","活跃用户数","activiteUserNum","新增模版数","templateNum","新增作品数","sceneNum","有作品企业数","sceneCompanyNum","有作品用户数","sceneUserNum","下载用户数","downloadUserNum","push","fileName","datas","sheetData","sheetName","sheetFilter","sheetHeader","toExcel","saveExcel","float","summaryData"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { Table, Button } from 'antd';\r\nimport ExportJsonExcel from 'js-export-excel';\r\n\r\n// 总量数据表格数据源\r\nconst columnSum = [\r\n  {\r\n    title: '日期',\r\n    dataIndex: 'id',\r\n    key: 'id',\r\n    align: 'center',\r\n    render: () => `${formVals.startTime ? `${formVals.startTime}至` : '至今'}${formVals.endTime ? formVals.endTime : ''}`,\r\n  },\r\n  {\r\n    title: '新增企业数',\r\n    dataIndex: 'intervalCompanyNum',\r\n    key: 'intervalCompanyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '活跃企业数',\r\n    dataIndex: 'intervalActiviteCompanyNum',\r\n    key: 'intervalActiviteCompanyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增用户数',\r\n    key: 'intervalUserNum',\r\n    dataIndex: 'intervalUserNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '活跃用户数',\r\n    key: 'intervalActiviteUserNum',\r\n    dataIndex: 'intervalActiviteUserNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增模版数',\r\n    key: 'intervalTemplateNum',\r\n    dataIndex: 'intervalTemplateNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增作品数',\r\n    key: 'intervalSceneNum',\r\n    dataIndex: 'intervalSceneNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '有作品企业数',\r\n    key: 'intervalSceneCompanyNum',\r\n    dataIndex: 'intervalSceneCompanyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '有作品用户数',\r\n    key: 'intervalSceneUserNum',\r\n    dataIndex: 'intervalSceneUserNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '下载用户数',\r\n    key: 'intervalDownloadUserNum',\r\n    dataIndex: 'intervalDownloadUserNum',\r\n    align: 'center',\r\n  },\r\n  // {\r\n  //   title: '作品下载数',\r\n  //   key: 'downloadSceneNum',\r\n  //   dataIndex: 'downloadSceneNum',\r\n  // },\r\n];\r\n\r\n// 数据筛选-单日数据-表格数据源\r\nconst columns = [\r\n  {\r\n    title: '日期',\r\n    dataIndex: 'dateTime',\r\n    key: 'dateTime',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增企业数',\r\n    dataIndex: 'companyNum',\r\n    key: 'companyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '活跃企业数',\r\n    dataIndex: 'activiteCompanyNum',\r\n    key: 'activiteCompanyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增用户数',\r\n    key: 'userNum',\r\n    dataIndex: 'userNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '活跃用户数',\r\n    key: 'activiteUserNum',\r\n    dataIndex: 'activiteUserNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增模版数',\r\n    key: 'templateNum',\r\n    dataIndex: 'templateNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '新增作品数',\r\n    key: 'sceneNum',\r\n    dataIndex: 'sceneNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '有作品企业数',\r\n    key: 'sceneCompanyNum',\r\n    dataIndex: 'sceneCompanyNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '有作品用户数',\r\n    key: 'sceneUserNum',\r\n    dataIndex: 'sceneUserNum',\r\n    align: 'center',\r\n  },\r\n  {\r\n    title: '下载用户数',\r\n    key: 'downloadUserNum',\r\n    dataIndex: 'downloadUserNum',\r\n    align: 'center',\r\n  },\r\n];\r\nconst ExportExcel =()=>{\r\n    const cloneData = {\r\n      id: 1,\r\n      intervalActiviteCompanyNum: 5864,\r\n      intervalActiviteUserNum: 8458,\r\n      intervalCompanyNum: 1854,\r\n      intervalSceneNum: 84459,\r\n      intervalUserNum: 4451,\r\n      intervalTemplateNum: 695,\r\n      intervalDownloadUserNum: 85,\r\n      intervalSceneCompanyNum: 62,\r\n      intervalSceneUserNum: 754,\r\n    };\r\n  \r\n    useEffect(() => {\r\n      // console.log(singleData.records);\r\n    });\r\n  \r\n    // 下载表格数据\r\n    const downloadExcel = type => {\r\n      const data =cloneData;// 表格数据\r\n      const option = {};\r\n      const dataTable = [];\r\n      if (data) {\r\n        Object.values(data).forEach(item => {\r\n          const obj = {\r\n            日期: type === 'singleData' ? item?.dateTime : `${formVals.startTime ? `${formVals.startTime}至` : '至今'}${formVals.endTime ? formVals.endTime : ''}`,\r\n            新增企业数: type === 'singleData' ? item?.companyNum : item?.intervalCompanyNum,\r\n            活跃企业数: type === 'singleData' ? item?.activiteCompanyNum : item?.intervalActiviteCompanyNum,\r\n            新增用户数: type === 'singleData' ? item?.userNum : item?.intervalUserNum,\r\n            活跃用户数: type === 'singleData' ? item?.activiteUserNum : item?.intervalActiviteUserNum,\r\n            新增模版数: type === 'singleData' ? item?.templateNum : item?.intervalTemplateNum,\r\n            新增作品数: type === 'singleData' ? item?.sceneNum : item?.intervalSceneNum,\r\n            有作品企业数: type === 'singleData' ? item?.sceneCompanyNum : item?.intervalSceneCompanyNum,\r\n            有作品用户数: type === 'singleData' ? item?.sceneUserNum : item?.intervalSceneUserNum,\r\n            下载用户数: type === 'singleData' ? item?.downloadUserNum : item?.intervalDownloadUserNum,\r\n          };\r\n          dataTable.push(obj);\r\n        });\r\n      }\r\n      option.fileName = type === 'singleData' ? '单日数据' : '总量数据';\r\n      option.datas = [\r\n        {\r\n          sheetData: dataTable,\r\n          sheetName: 'sheet',\r\n          sheetFilter: ['日期', '新增企业数', '活跃企业数', '新增用户数', '活跃用户数', '新增模版数', '新增作品数', '有作品企业数', '有作品用户数', '下载用户数'],\r\n          sheetHeader: ['日期', '新增企业数', '活跃企业数', '新增用户数', '活跃用户数', '新增模版数', '新增作品数', '有作品企业数', '有作品用户数', '下载用户数'],\r\n        },\r\n      ];\r\n      const toExcel = new ExportJsonExcel(option);\r\n      toExcel.saveExcel();\r\n    };\r\n  \r\n    return (\r\n      <div>\r\n        <h4 className=\"title-header\">\r\n        总量数据\r\n        <Button type=\"primary\" style={{ float: 'right' }} onClick={() => downloadExcel('summaryData')}>\r\n            导出数据\r\n        </Button>\r\n        </h4>\r\n        <Table\r\n        align=\"center\"\r\n        pagination={false}\r\n        columns={columnSum}\r\n        dataSource={[cloneData]}\r\n        rowKey={summaryData => summaryData.id}\r\n        className=\"form-container\"\r\n        />\r\n      </div>\r\n    );\r\n}\r\n\r\nexport default ExportExcel;\r\n// 此文件是  数据概览  -  海报-数据看板  -  数据筛选  组件\r\n\r\n"]},"metadata":{},"sourceType":"module"}